{% extends "base.html" %}
{% load static %}

{% block title %}Ficha libro {{ obj.isbn }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/book.css' %}">
<style>
  @media print {
    .d-print-none { display: none !important; }
    a[href]:after { content: ""; }
    .card { box-shadow: none !important; }
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-3" style="max-width: 1040px;">

  <!-- Encabezado + acciones -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">Ficha del libro</h1>
    <div class="d-print-none">
      <a class="btn btn-outline-secondary" href="{% url 'roles:panel' %}">Volver</a>
      <button class="btn btn-secondary" onclick="window.print()">Imprimir</button>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">

      <!-- Layout 2 columnas -->
      <div class="book-layout gap-4">

        <!-- Columna izquierda: portada -->
        <div class="book-left">
          {% if obj.portada %}
            <img src="{{ obj.portada.url }}" alt="Portada del libro" class="book-cover">
          {% else %}
            <img src="{% static 'img/cover.jpeg' %}" alt="Portada del libro" class="book-cover">
          {% endif %}
        </div>

        <!-- Columna derecha: título + acordeón -->
        <div class="book-right">
          <h3 class="book-title mb-1">{{ obj.titulo }}</h3>
          <p class="book-author text-muted mb-3">
            {{ obj.autor|default:"—" }}
          </p>

          <!-- Acordeón Bootstrap -->
          <div class="accordion" id="acordeonLibro">

            <!-- Identificación -->
            <div class="accordion-item">
              <h2 class="accordion-header" id="encabezadoUno">
                <button class="accordion-button" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelUno"
                        aria-expanded="true" aria-controls="panelUno">
                  Identificación del Libro
                </button>
              </h2>
              <div id="panelUno" class="accordion-collapse collapse show"
                   aria-labelledby="encabezadoUno" data-bs-parent="#acordeonLibro">
                <div class="accordion-body">
                  <dl class="row mb-0">
                    <dt class="col-sm-4 text-muted">ISBN</dt>
                    <dd class="col-sm-8">{{ obj.isbn|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Título</dt>
                    <dd class="col-sm-8">{{ obj.titulo|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Subtítulo</dt>
                    <dd class="col-sm-8">{{ obj.subtitulo|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Autor prólogo</dt>
                    <dd class="col-sm-8">{{ obj.autor_prologo|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Ilustrador</dt>
                    <dd class="col-sm-8">{{ obj.ilustrador|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Traductor</dt>
                    <dd class="col-sm-8">{{ obj.traductor|default:"—" }}</dd>
                  </dl>
                </div>
              </div>
            </div>

            <!-- Editorial y Edición -->
            <div class="accordion-item">
              <h2 class="accordion-header" id="encabezadoDos">
                <button class="accordion-button collapsed" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelDos"
                        aria-expanded="false" aria-controls="panelDos">
                  Editorial y Edición
                </button>
              </h2>
              <div id="panelDos" class="accordion-collapse collapse"
                   aria-labelledby="encabezadoDos" data-bs-parent="#acordeonLibro">
                <div class="accordion-body">
                  <dl class="row mb-0">
                    <dt class="col-sm-4 text-muted">Editorial</dt>
                    <dd class="col-sm-8">{{ obj.editorial.nombre|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">N° de edición</dt>
                    <dd class="col-sm-8">{{ obj.numero_edicion|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Fecha edición</dt>
                    <dd class="col-sm-8">
                      {% if obj.fecha_edicion %}{{ obj.fecha_edicion|date:"d/m/Y" }}{% else %}—{% endif %}
                    </dd>

                    <dt class="col-sm-4 text-muted">País de edición</dt>
                    <dd class="col-sm-8">{{ obj.pais_edicion|default:"—" }}</dd>
                  </dl>
                </div>
              </div>
            </div>

            <!-- Dimensiones -->
            <div class="accordion-item">
              <h2 class="accordion-header" id="encabezadoTres">
                <button class="accordion-button collapsed" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelTres"
                        aria-expanded="false" aria-controls="panelTres">
                  Dimensiones Físicas
                </button>
              </h2>
              <div id="panelTres" class="accordion-collapse collapse"
                   aria-labelledby="encabezadoTres" data-bs-parent="#acordeonLibro">
                <div class="accordion-body">
                  <dl class="row mb-0">
                    <dt class="col-sm-5 text-muted">Número de páginas</dt>
                    <dd class="col-sm-7">{{ obj.paginas|default:"—" }}</dd>

                    <dt class="col-sm-5 text-muted">Tipo de tapa</dt>
                    <dd class="col-sm-7">{{ obj.tipo_tapa|default:"—" }}</dd>

                    <dt class="col-sm-5 text-muted">Alto (cm)</dt>
                    <dd class="col-sm-7">{{ obj.alto_cm|default:"—" }}</dd>

                    <dt class="col-sm-5 text-muted">Ancho (cm)</dt>
                    <dd class="col-sm-7">{{ obj.ancho_cm|default:"—" }}</dd>

                    <dt class="col-sm-5 text-muted">Grosor (cm)</dt>
                    <dd class="col-sm-7">{{ obj.grosor_cm|default:"—" }}</dd>

                    <dt class="col-sm-5 text-muted">Peso (gr)</dt>
                    <dd class="col-sm-7">{{ obj.peso_gr|default:"—" }}</dd>
                  </dl>
                </div>
              </div>
            </div>

            <!-- Idioma y Contenido -->
            <div class="accordion-item">
              <h2 class="accordion-header" id="encabezadoCuatro">
                <button class="accordion-button collapsed" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelCuatro"
                        aria-expanded="false" aria-controls="panelCuatro">
                  Idioma y Contenido
                </button>
              </h2>
              <div id="panelCuatro" class="accordion-collapse collapse"
                   aria-labelledby="encabezadoCuatro" data-bs-parent="#acordeonLibro">
                <div class="accordion-body">
                  <dl class="row mb-0">
                    <dt class="col-sm-4 text-muted">Idioma original</dt>
                    <dd class="col-sm-8">{{ obj.idioma_original|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Temática</dt>
                    <dd class="col-sm-8">{{ obj.tematica|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Rango etario</dt>
                    <dd class="col-sm-8">{{ obj.rango_etario|default:"—" }}</dd>
                  </dl>
                </div>
              </div>
            </div>

            <!-- Precio y Distribución -->
            <div class="accordion-item">
              <h2 class="accordion-header" id="encabezadoCinco">
                <button class="accordion-button collapsed" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelCinco"
                        aria-expanded="false" aria-controls="panelCinco">
                  Precio y Distribución
                </button>
              </h2>
              <div id="panelCinco" class="accordion-collapse collapse"
                   aria-labelledby="encabezadoCinco" data-bs-parent="#acordeonLibro">
                <div class="accordion-body">
                  <dl class="row mb-0">
                    <dt class="col-sm-4 text-muted">Precio</dt>
                    <dd class="col-sm-8">{{ obj.precio|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Moneda</dt>
                    <dd class="col-sm-8">{{ obj.moneda|default:"—" }}</dd>

                    <dt class="col-sm-4 text-muted">Desc. distribuidor</dt>
                    <dd class="col-sm-8">{{ obj.descuento_distribuidor|default:"—" }}</dd>
                  </dl>
                </div>
              </div>
            </div>

            <!-- Resumen -->
            <div class="accordion-item">
              <h2 class="accordion-header" id="encabezadoSeis">
                <button class="accordion-button collapsed" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelSeis"
                        aria-expanded="false" aria-controls="panelSeis">
                  Resumen
                </button>
              </h2>
              <div id="panelSeis" class="accordion-collapse collapse"
                   aria-labelledby="encabezadoSeis" data-bs-parent="#acordeonLibro">
                <div class="accordion-body">
                  <p class="mb-0">{{ obj.resumen|linebreaksbr|default:"—" }}</p>
                </div>
              </div>
            </div>

          </div><!-- /accordion -->
        </div><!-- /book-right -->
      </div><!-- /book-layout -->

    </div>
  </div>
</div>

<!-- Bootstrap JS (si no está en base.html) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}