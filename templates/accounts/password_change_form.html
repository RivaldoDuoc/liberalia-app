
<!----------------------------------------------------------------------------
Formulario para que el usuario cambie su contraseña:

- Extiende la plantilla base (`base.html`) para mantener el estilo y layout.
- Solicita la contraseña actual y la nueva (con confirmación) cumpliendo requisitos de seguridad.
- Usa validación del lado del cliente (Bootstrap) y del servidor (Django Form).
- Muestra errores si los datos ingresados no son válidos.
- Forma parte del flujo de gestión de cuentas de usuario.
# ----------------------------------------------------------------------------->


{% extends "base.html" %}
{% load static %}

{% block title %}Cambiar contraseña - Liberalia{% endblock %}

{% block content %}


  <h5 class="text-center mb-3">Cambiar contraseña</h5>

  <form method="post" class="needs-validation" novalidate>
    {% csrf_token %}

    <!-- Clave actual -->
    <div class="mb-3">
      <input type="password" name="old_password" id="id_old_password"
             class="form-control" placeholder="Contraseña actual"
             required autocomplete="current-password">
      <div class="invalid-feedback">Ingresa tu contraseña actual.</div>
    </div>

    <!-- Nueva contraseña -->
    <div class="mb-3">
      <input type="password" name="new_password1" id="id_new_password1"
             class="form-control"
             placeholder="Nueva contraseña"
             required minlength="8"
             autocomplete="new-password"
             pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}$"
             title="Mínimo 8 caracteres, con letras, números y un símbolo.">
       <div class="invalid-feedback">La nueva contraseña no cumple los requisitos.</div>
    </div>

    <!-- Confirmación -->
    <div class="mb-3">
      <input type="password" name="new_password2" id="id_new_password2"
             class="form-control" placeholder="Confirmar nueva contraseña"
             required autocomplete="new-password">
      <div class="invalid-feedback">Confirma la nueva contraseña.</div>
    </div>

    <div class="d-grid">
      <button type="submit" class="btn btn-dark rounded-4 py-2">Guardar</button>
    </div>

    {% if form.errors %}
      <div class="alert alert-danger mt-3 mb-0" role="alert">
        {% for field, errors in form.errors.items %}
          {% for e in errors %}{{ e }}<br>{% endfor %}
        {% endfor %}
      </div>
    {% endif %}
  </form>
</div>
{% endblock %}
